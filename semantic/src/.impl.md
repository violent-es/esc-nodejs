# Implementation

## Progress track

- [ ] Logic
  - [ ] InterfaceImpl
  - [ ] MethodOverride
  - [ ] PropertyResolution
  - [ ] TypeConversions
    - [ ] ConversionFromTo
  - [ ] ValueIndexing
- [ ] Model
  - [ ] ModelCore
    - [ ] Reference to top-level package
    - [ ] Built-ins
    - [ ] Factory instance
    - [ ] Operation for interning structural/instantiated types (including unions and nullable types)
    - [ ] Operation for interning instantiated variable slots
    - [ ] Operation for interning instantiated virtual slots
    - [ ] Operation for interning instantiated method slots
  - [x] Visibility
  - [ ] Factory
  - [ ] Properties
    - [ ] `*[Symbol.iterator]()` yields `[name, symbol]`
  - [ ] PropertiesHierarchy
    - [ ] `*[Symbol.iterator]()` yields `[name, symbol, definedByType]`
  - [x] NameAndTypePair
  - [ ] Issues
    - [ ] AmbiguousReferenceIssue
      - [ ] `name`
      - [ ] `base: Symbol | null` (`null` if it is a lexical ambiguity)
  - [ ] Alias
    - [ ] `parentDefinition`
    - [ ] `name`
    - [ ] `aliasToSymbol`
    - [ ] `visibility`
  - [ ] TypeSystem
    - [ ] DefaultValue (not a symbol)
    - [ ] TypeRelationship (not a symbol)
      - [ ] `isSubtypeOf()`
    - [ ] TypeReplacement (not a symbol)
      - Operates on almost all kinds of symbols (variable slots, types etc.)
    - [ ] InstanceDelegate
      - [ ] `associatedType`
      - [ ] `properties`
      - [ ] `proxies: null | Map<Operator, Symbol>`
    - [ ] ?Type
      - [ ] `visibility`
      - [ ] `isSubtypeOf()` (uses `TypeRelationship`)
      - [ ] `defaultValue` (uses `DefaultValue`)
    - [ ] AnyType
      - [ ] `includesUndefined = true`
      - [ ] `includesNull = true`
    - [ ] UndefinedType
      - [ ] `includesUndefined = true`
    - [ ] NullType
      - [ ] `includesNull = true`
    - [ ] ClassType
      - [ ] `parentDefinition`
      - [ ] `superType`
      - [ ] `directSuperTypes`
      - [ ] `implementsInterfaces`
      - [ ] `isValueClass`
      - [ ] `isFinal`
      - [ ] `name`
      - [ ] `typeParameters`
      - [ ] `properties`
      - [ ] `delegate`
      - [ ] `constructorDefinition`
    - [ ] EnumType
      - [ ] `parentDefinition`
      - [ ] `superType`
      - [ ] `numericType`
      - [ ] `name`
      - [ ] `isFlagsEnum`
      - [ ] `properties`
      - [ ] `enumVariants: Map<string, numericValue>`
      - [ ] `delegate`
      - [ ] `enumHasVariantByString(stringValue): boolean`
      - [ ] `enumHasVariantByNumber(numericValue): boolean`
      - [ ] `enumSetVariant(stringValue, numericValue)`
    - [ ] InterfaceType
      - [ ] `parentDefinition`
      - [ ] `directSuperTypes`
      - [ ] `name`
      - [ ] `typeParameters`
      - [ ] `properties`
      - [ ] `delegate`
    - [ ] FunctionType
      - [ ] `superType = modelCore.functionType`
      - [ ] `functionRequiredParameters: NameAndTypePair[] | null`
      - [ ] `functionOptParameters: NameAndTypePair[] | null`
      - [ ] `functionRestParameter: NameAndTypePair | null`
      - [ ] `functionReturnType: Symbol | null`
    - [ ] TupleType
      - [ ] `superType = modelCore.objectType`
      - [ ] `tupleElementTypes`
    - [ ] RecordType
      - [ ] `superType = modelCore.objectType`
      - [ ] `recordProperties`
    - [ ] UnionType
      - [ ] `includesUndefined = ?`
      - [ ] `includesNull = ?`
      - [ ] `unionMemberTypes`
      - [ ] UndefinedAndNullAndAnotherUnionType
        - [ ] `includesUndefined = true`
        - [ ] `includesNull = true`
      - [ ] UndefinedAndAnotherUnionType
        - [ ] `includesUndefined = true`
      - [ ] NullAndAnotherUnionType
        - [ ] `includesNull = true`
    - [ ] InstantiatedType
      - [ ] `originalDefinition`
      - [ ] `argumentTypes`
      - [ ] `isInstantiated = true`
    - [ ] TypeParameter
      - [ ] `name`
      - [ ] `typeParameterImplements`
      - [ ] `typeParameterExtendsClass`
      - [ ] `directSuperTypes`
        - Mix of implemented interfaces and extended class
  - [ ] Namespace
    - [ ] Package (subtype of `Namespace`)
  - [ ] NamespaceSet
  - [ ] VariableSlot
    - [ ] `parentDefinition`
    - [ ] `readOnly`
    - [ ] `visibility`
    - [ ] `name`
    - [ ] `staticType`
    - [ ] `initValue`
    - [ ] `shadowFrame` (next frame, allowing a variable of the same name to appear in the same block)
    - [ ] InstantiatedVariableSlot
      - [ ] `isInstantiated = true`
      - [ ] `originalDefinition`
  - [ ] VirtualSlot
    - [ ] `parentDefinition`
    - [ ] `readOnly`
    - [ ] `writeOnly`
    - [ ] `name`
    - [ ] `staticType`
    - [ ] `getter`
    - [ ] `setter`
    - [ ] `visibility`
    - [ ] InstantiatedVirtualSlot
      - [ ] `isInstantiated = true`
      - [ ] `originalDefinition`
  - [ ] MethodSlot
    - [ ] `parentDefinition`
    - [ ] `name`
    - [ ] `staticType`
    - [ ] `visibility`
    - [ ] `usesYield`
    - [ ] `usesAwait`
    - [ ] `hasOverrideModifier`
    - [ ] `isFinal`
    - [ ] `isNative`
    - [ ] `typeParameters`
    - [ ] InstantiatedMethodSlot
      - [ ] `isInstantiated = true`
      - [ ] `originalDefinition`
      - [ ] `argumentTypes`
  - [ ] Value
    - [ ] ?Value
      - [ ] `staticType`
    - [ ] ConstantValue
      - [ ] UndefinedConstantValue
      - [ ] NullConstantValue
      - [ ] StringConstantValue
        - [ ] `stringValue`
      - [ ] BooleanConstantValue
        - [ ] `booleanValue`
      - [ ] NumberConstantValue
        - [ ] `numberValue`
      - [ ] DecimalConstantValue
        - [ ] `decimalValue`
      - [ ] ByteConstantValue
        - [ ] `byteValue`
      - [ ] ShortConstantValue
        - [ ] `shortValue`
      - [ ] IntConstantValue
        - [ ] `intValue`
      - [ ] LongConstantValue
        - [ ] `longValue`
      - [ ] BigIntConstantValue
        - [ ] `bigIntValue`
    - [ ] TypeAsValue
      - [ ] `tavType`
    - [ ] NamespaceAsValue
      - [ ] `navNamespace`
    - [ ] ThisValue
    - [ ] TypeStaticThisValue
      - [ ] `typeStaticThisType`
    - [ ] ReferenceValue
      - [ ] `propertyDefinedByType`
    - [ ] ReferenceValueOfPossiblyUndefined
      - [ ] `propertyDefinedByType`
    - [ ] ReferenceValueOfPossiblyUndefinedOrNull
      - [ ] `propertyDefinedByType`
    - [ ] ReferenceValueOfPossiblyNull
      - [ ] `propertyDefinedByType`
    - [ ] DynamicReferenceValue
    - [ ] IndexValue
    - [ ] IndexValueOfPossiblyUndefined
    - [ ] IndexValueOfPossiblyUndefinedOrNull
    - [ ] IndexValueOfPossiblyNull
    - [ ] DynamicIndexValue
    - [ ] ConversionValue
      - [ ] `conversionFromTo`
      - [ ] `conversionIsExplicit`
      - [ ] `conversionIsOptional`
    - [ ] FunctionExpValue
  - [ ] Frame
    - [ ] ?Frame
      - [ ] `properties`
      - [ ] `openNamespaces`
    - [ ] ActivationFrame
      - [ ] `extendedLifeVariables: Set<Symbol>` (set of slots)
    - [ ] ClassFrame
    - [ ] EnumFrame
    - [ ] InterfaceFrame
    - [ ] NamespaceFrame
    - [ ] PackageFrame
    - [ ] WithFrame

## Numeric types

To support additional numeric types:

- Introduce a built-in class in `ModelCore`
- Introduce a `ConstantValue` subtype
- Resolve default constant value in `TypeSystem.DefaultValue`
- Provide conversions between other numeric types at `TypeConversions` logic
- Provide a correspoding `Factory` method